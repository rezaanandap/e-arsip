<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>E-Arsip KPU - Penomoran & Arsip Digital</title>

  <!-- Favicon (opsional) -->
  <link rel="icon" type="image/png" href="logo-gold.png" />

  <!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- CSS -->
  <link rel="stylesheet" href="style.css" />
</head>

<body data-page="index">

  <!-- TOPBAR -->
  <header class="topbar">
  <div class="topbar-inner">
    <div class="brand">
      <div class="logo">
          <img src="logo-gold.png" alt="KPU">
      </div>
      <div>
        <div class="title">E-ARSIP KPU</div>
        <div class="subtitle" style="color: #cbd5e1; font-size: 0.8rem;">Manajemen Penomoran Digital</div>
      </div>
    </div>
    <div class="top-actions">
      <a href="login.html" class="btn btn-outline" style="padding: 0.5rem 1rem; font-size: 0.8rem;">
        Login Admin
      </a>
    </div>
  </div>
</header>

  <!-- WRAP -->
  <main class="wrap">

    <!-- HERO -->
    <section class="card" style="text-align: center; background: linear-gradient(to right, #1e293b, #334155); color: white;">
        <h1 style="margin: 0; font-size: 2rem;">Selamat Datang</h1>
        <p style="opacity: 0.8;">Silakan ambil nomor dokumen atau cari arsip pada menu di bawah.</p>
    </section>

    <!-- NAV TABS -->
    <section class="tabs">
      <button id="btnTabNomor" class="tab active" onclick="showPublicTab('tabNomor')">
        Buat Nomor Dokumen
      </button>
      <button id="btnTabArsip" class="tab" onclick="showPublicTab('tabArsip')">
        Upload Arsip PDF
      </button>
      <button id="btnTabCari" class="tab" onclick="showPublicTab('tabCari')">
        Cari Data
      </button>
    </section>

    <!-- =========================
         TAB 1: NOMOR DOKUMEN
         ========================= -->
    <section id="tabNomor" class="card">

      <div class="card-head">
        <div>
          <h2>Buat Nomor Dokumen</h2>
          <p class="hint">
            Nomor akan dibuat otomatis berdasarkan tipe dokumen, tanggal, dan kode surat.
          </p>
        </div>
      </div>

      <div class="grid-2">

        <div>
          <div class="label">Tipe Dokumen</div>
          <select id="tipeDokumen" class="select">
            <option value="SuratKeluar">Surat Keluar</option>
            <option value="BeritaAcara">Berita Acara</option>
            <option value="SuratKeputusan">Surat Keputusan</option>
            <option value="SuratTugas">Surat Tugas</option>
          </select>
        </div>

        <div>
          <div class="label">Tanggal Dokumen</div>
          <input id="tanggalDokumen" type="date" class="input" />
          <div id="lastTanggalHint" class="hint">Memuat tanggal terakhir...</div>
        </div>

        <div class="span-2">
          <div class="label">Perihal</div>
          <input id="perihal" class="input" placeholder="Contoh: Undangan Rapat / Permohonan / Laporan" />
        </div>

        <div>
          <div class="label">Pengambil</div>
          <input id="pengambil" class="input" placeholder="Nama pegawai pengambil nomor" />
        </div>

        <div>
          <div class="label">Kode Surat (Manual)</div>
          <input id="kodeManual" class="input" placeholder="Contoh: KPU-KAB/XXX" />
          <div class="hint">
            Wajib untuk Surat Keluar / Berita Acara / Surat Tugas.
            Untuk SK akan diabaikan.
          </div>
        </div>

        <!-- Dynamic Fields -->
        <div id="dynamicFields" class="span-2"></div>

      </div>

      <div class="actions">
        <button id="btnSubmitNomor" class="btn btn-primary" onclick="submitNomor()">
          Buat Nomor
        </button>
      </div>

      <hr class="sep" />

      <div>
        <h3 style="margin:0 0 10px 0;">Hasil Nomor Terakhir</h3>
        <div id="hasilCards" class="cards">
          <div class="hint">Belum ada nomor dibuat pada sesi ini.</div>
        </div>
      </div>

    </section>

    <!-- =========================
         TAB 2: UPLOAD ARSIP
         ========================= -->
    <section id="tabArsip" class="card hidden">

      <div class="card-head">
        <div>
          <h2>Upload Arsip PDF</h2>
          <p class="hint">
            Upload file PDF maksimal 2MB. File akan tersimpan di Google Drive.
          </p>
        </div>
      </div>

      <div class="grid-2">

        <div class="span-2">
          <div class="label">Nomor Dokumen</div>
          <input id="arsipNomor" class="input" placeholder="Tempel nomor dokumen yang sudah dibuat" />
        </div>

        <div class="span-2">
          <div class="label">Perihal</div>
          <input id="arsipPerihal" class="input" placeholder="Perihal singkat dokumen" />
        </div>

        <div>
          <div class="label">Tipe Arsip</div>
          <select id="arsipTipe" class="select"></select>
          <div class="hint">Diambil dari sheet: ref_tipe_arsip</div>
        </div>

        <div>
          <div class="label">Pengunggah</div>
          <input id="arsipPengunggah" class="input" placeholder="Nama pengunggah" />
        </div>

        <div class="span-2">
          <div class="label">File PDF</div>
          <input id="arsipFile" type="file" class="input" accept="application/pdf,.pdf" />
          <div class="hint">
            Pastikan file PDF. Maksimal 2MB.
          </div>
        </div>

      </div>

      <div class="actions">
        <button id="btnSubmitArsip" class="btn btn-primary" onclick="submitArsip()">
          Upload Arsip
        </button>
      </div>

    </section>

    <!-- =========================
         TAB 3: SEARCH
         ========================= -->
    <section id="tabCari" class="card hidden">

      <div class="card-head">
        <div>
          <h2>Cari Data</h2>
          <p class="hint">
            Ketik nomor dokumen, perihal, pengambil, tujuan, atau kata kunci lainnya.
          </p>
        </div>
      </div>

      <div class="grid-2">
        <div class="span-2">
          <div class="label">Kata Kunci</div>
          <input id="searchKeyword" class="input" placeholder="Contoh: Undangan, Reza, KPU-KAB, 2026, dll..." />
          <div class="hint">Search real-time aktif (dengan delay 0.45 detik).</div>
        </div>
      </div>

      <hr class="sep" />

      <div class="grid-2">

        <div>
          <h3 style="margin:0 0 8px 0;">Hasil Pencatatan Nomor</h3>
          <div id="searchLogs">
            <div class="hint">Masukkan kata kunci untuk mulai mencari.</div>
          </div>
        </div>

        <div>
          <h3 style="margin:0 0 8px 0;">Hasil Arsip Digital</h3>
          <div id="searchArsip">
            <div class="hint">Masukkan kata kunci untuk mulai mencari.</div>
          </div>
        </div>

      </div>

    </section>

    <!-- FOOTER -->
    <footer class="footer">
      <div>
        <b>E-Arsip KPU</b> — Sistem Penomoran & Arsip Digital
      </div>
      <div class="hint">
        © 2026 • Dibuat dengan Google Apps Script + GitHub Pages
      </div>
    </footer>

  </main>

  <!-- =========================
       MODAL EDIT (SHARED)
       ========================= -->
  <div id="modalBackdrop" class="modal-backdrop">
    <div class="modal">
      <div class="modal-head">
        <div>
          <div id="modalTitle" class="modal-title">Edit Data</div>
          <div class="hint">Perubahan akan tersimpan ke Google Sheet.</div>
        </div>
        <button id="btnModalClose" class="btn btn-sm btn-soft">Tutup</button>
      </div>

      <div id="modalBody" class="modal-body">
        <!-- dynamic -->
      </div>

      <div class="modal-actions">
        <button id="btnModalSave" class="btn btn-primary">
          Simpan Perubahan
        </button>
      </div>
    </div>
  </div>

  <!-- JS -->
  <script src="script.js"></script>
</body>
</html>
